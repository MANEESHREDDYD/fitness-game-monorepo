{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Android: Start Emulator (Pixel 6 API 34)",
      "type": "shell",
      "command": "emulator",
      "args": ["-avd", "Pixel_6_API_34"],
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^.*$",
          "file": 1,
          "location": 2,
          "message": 3
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": ".*emulator.*",
          "endsPattern": ".*boot.*"
        }
      },
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "showReuseMessage": true
      },
      "windows": {
        "command": "cmd",
        "args": ["/c", "emulator -avd Pixel_6_API_34"]
      }
    },
    {
      "label": "Android: Verify Devices Connected",
      "type": "shell",
      "command": "adb",
      "args": ["devices"],
      "presentation": {
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "windows": {
        "command": "adb",
        "args": ["devices"]
      }
    },
    {
      "label": "Android: Deploy React Native App",
      "type": "shell",
      "command": "npm",
      "args": ["run", "android"],
      "cwd": "${workspaceFolder}/mobile-app",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": {
        "pattern": {
          "regexp": "^.*error.*$",
          "file": 1,
          "message": 0
        },
        "severity": "error"
      },
      "windows": {
        "command": "npm",
        "args": ["run", "android"]
      }
    },
    {
      "label": "Android: Start Emulator + Deploy App",
      "dependsOn": [
        "Android: Start Emulator (Pixel 6 API 34)",
        "Android: Verify Devices Connected"
      ],
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "showReuseMessage": false
      }
    },
    {
      "label": "Backend: Start Dev Server",
      "type": "shell",
      "command": "npm",
      "args": ["run", "dev"],
      "cwd": "${workspaceFolder}/backend-api",
      "isBackground": true,
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": {
        "pattern": {
          "regexp": "^.*error.*$",
          "message": 0
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": ".*compiling.*",
          "endsPattern": ".*listening.*3000.*"
        }
      },
      "windows": {
        "command": "npm",
        "args": ["run", "dev"]
      }
    },
    {
      "label": "React: Start Metro Bundler",
      "type": "shell",
      "command": "npm",
      "args": ["start"],
      "cwd": "${workspaceFolder}/mobile-app",
      "isBackground": true,
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": {
        "pattern": {
          "regexp": "^.*error.*$",
          "message": 0
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": ".*metro.*",
          "endsPattern": ".*8081.*"
        }
      },
      "windows": {
        "command": "npm",
        "args": ["start"]
      }
    },
    {
      "label": "Full Stack: Start All (Backend + Metro + Emulator + Deploy)",
      "dependsOn": [
        "Backend: Start Dev Server",
        "React: Start Metro Bundler",
        "Android: Start Emulator (Pixel 6 API 34)",
        "Android: Verify Devices Connected",
        "Android: Deploy React Native App"
      ],
      "group": {
        "kind": "build",
        "isDefault": false
      },
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "showReuseMessage": false
      }
    },
    {
      "label": "Test: Run All Tests",
      "type": "shell",
      "command": "npm",
      "args": ["test"],
      "cwd": "${workspaceFolder}/mobile-app",
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": {
        "pattern": {
          "regexp": "^.*FAIL.*$|^.*ERROR.*$",
          "message": 0
        }
      },
      "windows": {
        "command": "npm",
        "args": ["test"]
      }
    },
    {
      "label": "Tools: View Device Logs",
      "type": "shell",
      "command": "adb",
      "args": ["logcat", "-s", "Fitness Game"],
      "presentation": {
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "isBackground": true,
      "problemMatcher": {
        "background": {
          "activeOnStart": true,
          "beginsPattern": ".*",
          "endsPattern": "$^"
        }
      },
      "windows": {
        "command": "adb",
        "args": ["logcat"]
      }
    }
  ]
}
