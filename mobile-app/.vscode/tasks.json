{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Start Android Emulator (Pixel 6 API 34)",
      "type": "shell",
      "command": "emulator",
      "args": ["-avd", "Pixel_6_API_34", "-netdelay", "none", "-netspeed", "full"],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "problemMatcher": [],
      "isBackground": true,
      "detail": "Starts the Android emulator (Pixel 6 API 34). Run this before building the app."
    },
    {
      "label": "Check ADB Devices",
      "type": "shell",
      "command": "adb",
      "args": ["devices"],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      },
      "problemMatcher": [],
      "detail": "Lists all connected Android devices and emulators"
    },
    {
      "label": "Build & Deploy to Emulator",
      "type": "shell",
      "command": "npm",
      "args": ["run", "android"],
      "cwd": "${workspaceFolder}/mobile-app",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "problemMatcher": {
        "pattern": {
          "regexp": "^(.*):\\s+(.*?):\\s+(.*)$",
          "file": 1,
          "message": 3
        }
      },
      "detail": "Runs Gradle to build the APK and deploy to the connected emulator"
    },
    {
      "label": "Start Metro Bundler",
      "type": "shell",
      "command": "npm",
      "args": ["start"],
      "cwd": "${workspaceFolder}/mobile-app",
      "isBackground": true,
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "problemMatcher": {
        "pattern": "^(.*):\\s*(.*?):\\s*(.*)$",
        "background": {
          "activeOnStart": true,
          "beginsPattern": "âœ“ Metro bundler ready",
          "endsPattern": "error occurred|listening on"
        }
      },
      "detail": "Starts the Metro JavaScript bundler on port 8081"
    },
    {
      "label": "Run Backend API (localhost:3000)",
      "type": "shell",
      "command": "npm",
      "args": ["run", "dev"],
      "cwd": "${workspaceFolder}/backend-api",
      "isBackground": true,
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      },
      "problemMatcher": {
        "pattern": "^(.*):\\s*(.*?):\\s*(.*)$",
        "background": {
          "activeOnStart": true,
          "beginsPattern": "starting|listening",
          "endsPattern": "error|listening on port 3000"
        }
      },
      "detail": "Starts the backend Express server on localhost:3000"
    },
    {
      "label": "View ADB Logcat",
      "type": "shell",
      "command": "adb",
      "args": ["logcat", "-s", "FitnessGame:V", "ReactNativeJS:V"],
      "isBackground": true,
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "problemMatcher": [],
      "detail": "Shows filtered Android system logs (Fitness Game and React Native)"
    },
    {
      "label": "Clear Emulator Data",
      "type": "shell",
      "command": "adb",
      "args": ["shell", "pm", "clear", "com.fitnessgame"],
      "presentation": {
        "reveal": "always",
        "panel": "shared"
      },
      "problemMatcher": [],
      "detail": "Clears app cache and data from the running emulator"
    },
    {
      "label": "Generate Android APK",
      "type": "shell",
      "command": "cd",
      "args": ["${workspaceFolder}/mobile-app", "&&", "npm", "run", "android", "--mode=release"],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "problemMatcher": [],
      "detail": "Generates a release-mode APK for production deployment"
    },
    {
      "label": "Run All Feature Tests",
      "type": "shell",
      "command": "npm",
      "args": ["test", "--", "--testPathPattern=features\\\\..*\\\\.test\\\\.tsx"],
      "cwd": "${workspaceFolder}/mobile-app",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "problemMatcher": {
        "pattern": "FAIL|PASS"
      },
      "detail": "Executes all feature tests (Zone Capture, Match, Join, Map, Auth)"
    },
    {
      "label": "Run Backend Tests",
      "type": "shell",
      "command": "npm",
      "args": ["test"],
      "cwd": "${workspaceFolder}/backend-api",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "problemMatcher": {
        "pattern": "FAIL|PASS"
      },
      "detail": "Executes backend API tests"
    }
  ]
}
